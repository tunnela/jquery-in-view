/*
 2015, Lauri Tunnela (http://tunne.la)
 @license http://tunne.la/MIT.txt The MIT License
*/
;!function(l,z,c,A){function v(f,b){var d=c(f);f=d.get(0);var a=function(b,a){var c=d.data("iv-"+b);null==c&&(c=d.attr("iv-"+b));null==c&&(c=a);return c},k=function(b,a){a=a||!1;return c.isFunction(b)?b.apply(f):a?c(b):b},m=null,n=!1,q=0,e={count:parseInt(a("count",1)),classVisible:a("visible","in-view"),classHidden:a("hidden","out-of-view"),classInitial:a("initial","initial-view"),target:a("target",f),offset:a("offset","0"),marker:a("marker","")};b=c.extend({},e,b);var h=b.offset.split(/\s*,\s*/),
e=b.marker.split(/\s*,\s*/),r=h.length,g=c.isFunction(b.classInitial)?b.classInitial.apply(f):b.classInitial;d.addClass(g);d.trigger("initial-view");g={left:h[0],right:h[0],top:h[0],bottom:h[0]};4==r?(g.left=h[3],g.right=h[1],g.bottom=h[2]):2==r&&(g.left=h[1],g.right=h[1]);g.left=parseFloat(a("offset-left",g.left))||0;g.right=parseFloat(a("offset-right",g.right))||0;g.bottom=parseFloat(a("offset-bottom",g.bottom))||0;g.top=parseFloat(a("offset-top",g.top))||0;b.offset=g;""==e[0]&&(e=[]);var p={},
a=e.length;c.each(e,function(b,a){a=100*(parseFloat(a)||0);p[a]=a});if(e.length){e=e[0].match(/([0-9]+)\s*\/\s*([0-9]+)/);if(1===a&&e)for(a=parseFloat(e[2])||1,a=(parseFloat(e[1])||0)/(0==a?1:a),e=0,a=1/a;100>=e;e+=a)p[e]=e;p[0]=0;p[100]=100}b.marker=p;this.check=function(){if(!n){n=!0;var a=m;m=c.isVisible(f,b.offset);var e=100*c.visiblityFactor(f),g=k(b.target,!0),h=k(b.classVisible);c.each(p,function(b,a){a>e?g.removeClass(h+"-"+a):a<=e&&g.addClass(h+"-"+a)});if(a!=m)if(a=k(b.classInitial),d.removeClass(a),
m){if(d.trigger("in-view"),!b.count||q++<b.count)a=k(b.classHidden),g.length&&g.addClass(h).removeClass(a),d.trigger("in-view-pass")}else if(d.trigger("out-of-view"),!b.count||q<b.count)a=k(b.classHidden),g.length&&g.addClass(a).removeClass(h),d.trigger("out-of-view-pass");n=!1}};u=u.add(f);w||(w=!0,c(l).on("load scroll",x))}var w=!1,y=0,t=[],u=c(),x=function(f){c(this).scrollTop();c(this).scrollLeft();u.each(function(){var b=t[c(this).data("in-view")];b instanceof v&&b.check()})};c.fn.inView=function(f){var b=
[],d=this.each(function(){var a=c(this).data("in-view"),d=null;a&&"undefined"!==typeof t[a]?d=t[a]||null:(a=++y,c(this).data("in-view",a));null!==d&&f?b.push(d):(d=new v(this,f),t[a]=d)}),a=b.length;return a?1===a?b[0]:b:d};c.visiblityFactor=function(f){f=c(f).get(0);for(var b=f.offsetTop,d=f.offsetHeight;f.offsetParent;)f=f.offsetParent,b+=f.offsetTop;return(l.pageYOffset+l.innerHeight-b)/d};c.isVisible=function(f,b){var d=c(f).get(0),a=d.offsetTop,k=d.offsetLeft,m=d.offsetWidth,n=d.offsetHeight,
q=0,e=0,h=0,r=0;"undefined"!==typeof b&&(q=1<Math.abs(b.left)?b.left:b.left*m,e=1<Math.abs(b.right)?b.right:b.right*m,h=1<Math.abs(b.top)?b.top:b.top*n,r=1<Math.abs(b.bottom)?b.bottom:b.bottom*n);for(;d.offsetParent;)d=d.offsetParent,a+=d.offsetTop,k+=d.offsetLeft;return a+h<l.pageYOffset+l.innerHeight&&k+q<l.pageXOffset+l.innerWidth&&a+n+r>l.pageYOffset&&k+m+e>l.pageXOffset};c(function(){c("[data-iv-detect=false],[iv-detect=false]").first().length||c("[data-iv],[iv]").inView()})}(window,document,
window.Zepto||window.jQuery);