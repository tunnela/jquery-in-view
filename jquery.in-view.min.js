/*
 2015, Lauri Tunnela (http://tunne.la)
 @license http://tunne.la/MIT.txt The MIT License
*/
;!function(l,z,e,A){function v(c,b){var d=e(c);c=d.get(0);var a=function(b,c){var a=d.data("iv-"+b);null==a&&(a=d.attr("iv-"+b));null==a&&(a=c);return a},k=function(b,a){a=a||!1;return e.isFunction(b)?b.apply(c):a?e(b):b},m=null,n=!1,q=0,g={count:parseInt(a("count",1)),classVisible:a("visible","in-view"),classHidden:a("hidden","out-of-view"),classInitial:a("initial","initial-view"),target:a("target",c),offset:a("offset","0"),marker:a("marker","")};b=e.extend({},g,b);var h=b.offset.split(/\s*,\s*/),
g=b.marker.split(/\s*,\s*/),r=h.length,f=e.isFunction(b.classInitial)?b.classInitial.apply(c):b.classInitial;d.addClass(f);d.trigger("initial-view");f={left:h[0],right:h[0],top:h[0],bottom:h[0]};4==r?(f.left=h[3],f.right=h[1],f.bottom=h[2]):2==r&&(f.left=h[1],f.right=h[1]);f.left=parseFloat(a("offset-left",f.left))||0;f.right=parseFloat(a("offset-right",f.right))||0;f.bottom=parseFloat(a("offset-bottom",f.bottom))||0;f.top=parseFloat(a("offset-top",f.top))||0;b.offset=f;""==g[0]&&(g=[]);var p={},
a=g.length;e.each(g,function(b,a){a=parseFloat(a)||0;1>=a&&(a*=100);p[a]=a});if(g.length){g=parseFloat(g[0])||0;if(1===a&&0<g&&1>=g)for(a=0,g=1/g;100>=a;a+=g)p[a]=a;p[0]=0;p[100]=100}b.marker=p;this.check=function(){if(!n){n=!0;var a=m;m=e.isVisible(c,b.offset);var g=e.visiblityPercentage(c),f=k(b.target,!0),h=k(b.classVisible);e.each(p,function(b,a){a>g?f.removeClass(h+"-"+a):a<=g&&f.addClass(h+"-"+a)});if(a!=m)if(a=k(b.classInitial),d.removeClass(a),m){if(d.trigger("in-view"),!b.count||q++<b.count)a=
k(b.classHidden),f.length&&f.addClass(h).removeClass(a),d.trigger("in-view-pass")}else if(d.trigger("out-of-view"),!b.count||q<b.count)a=k(b.classHidden),f.length&&f.addClass(a).removeClass(h),d.trigger("out-of-view-pass");n=!1}};u=u.add(c);w||(w=!0,e(l).on("load scroll",x))}var w=!1,y=0,t=[],u=e(),x=function(c){e(this).scrollTop();e(this).scrollLeft();u.each(function(){var b=t[e(this).data("in-view")];b instanceof v&&b.check()})};e.fn.inView=function(c){var b=[],d=this.each(function(){var a=e(this).data("in-view"),
d=null;a&&"undefined"!==typeof t[a]?d=t[a]||null:(a=++y,e(this).data("in-view",a));null!==d&&c?b.push(d):(d=new v(this,c),t[a]=d)}),a=b.length;return a?1===a?b[0]:b:d};e.visiblityPercentage=function(c){c=e(c).get(0);for(var b=c.offsetTop,d=c.offsetHeight;c.offsetParent;)c=c.offsetParent,b+=c.offsetTop;c=(l.pageYOffset+l.innerHeight-b)/d*100;console.log(100<c?100:0>c?0:c);return 100<c?100:0>c?0:c};e.isVisible=function(c,b){var d=e(c).get(0),a=d.offsetTop,k=d.offsetLeft,m=d.offsetWidth,n=d.offsetHeight,
q=0,g=0,h=0,r=0;"undefined"!==typeof b&&(q=1<Math.abs(b.left)?b.left:b.left*m,g=1<Math.abs(b.right)?b.right:b.right*m,h=1<Math.abs(b.top)?b.top:b.top*n,r=1<Math.abs(b.bottom)?b.bottom:b.bottom*n);for(;d.offsetParent;)d=d.offsetParent,a+=d.offsetTop,k+=d.offsetLeft;return a+h<l.pageYOffset+l.innerHeight&&k+q<l.pageXOffset+l.innerWidth&&a+n+r>l.pageYOffset&&k+m+g>l.pageXOffset};e(function(){e("[data-iv-detect=false],[iv-detect=false]").first().length||e("[data-iv],[iv]").inView()})}(window,document,
window.Zepto||window.jQuery);