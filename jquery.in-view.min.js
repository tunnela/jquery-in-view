/*
 2015, Lauri Tunnela (http://tunne.la)
 @license http://tunne.la/MIT.txt The MIT License
*/
;!function(f,z,c,A){function u(b,a){var d=c(b);b=d.get(0);var e=function(a,b){var c=d.data("iv-"+a);null==c&&(c=d.attr("iv-"+a));null==c&&(c=b);return c},q=function(a,d){d=d||!1;return c.isFunction(a)?a.apply(b):d?c(a):a},l={},m={},n=null,p=!1,r=0,k={count:parseInt(e("count",1)),classVisible:e("visible","in-view"),classHidden:e("hidden","out-of-view"),classInitial:e("initial","initial-view"),target:e("target",b),offset:e("offset","0"),marker:e("marker",""),markerCount:parseInt(e("marker-count",1)),
viewportMarker:e("viewport-marker",""),viewportMarkerCount:parseInt(e("viewport-marker-count",1))};a=c.extend({},k,a);var k=a.offset.split(/\s*,\s*/),h=k.length,g=c.isFunction(a.classInitial)?a.classInitial.apply(b):a.classInitial;d.addClass(g);d.trigger("initial-view");g={left:k[0],right:k[0],top:k[0],bottom:k[0]};4==h?(g.left=k[3],g.right=k[1],g.bottom=k[2]):2==h&&(g.left=k[1],g.right=k[1]);g.left=parseFloat(e("offset-left",g.left))||0;g.right=parseFloat(e("offset-right",g.right))||0;g.bottom=parseFloat(e("offset-bottom",
g.bottom))||0;g.top=parseFloat(e("offset-top",g.top))||0;a.offset=g;a.marker=v(a.marker);a.viewportMarker=v(a.viewportMarker);this.check=function(){if(!p){p=!0;var e=n;n=c.isVisible(b,a.offset);var g=100*c.visiblityFactor(b),k=100*c.viewportVisiblityFactor(b),f=q(a.target,!0),h=q(a.classVisible);c.each(a.marker,function(b,c){"undefined"===typeof l[c]&&(l[c]=0);c<=g&&(!a.markerCount||l[c]++<a.markerCount)&&f.addClass(h+"-"+c);c>g&&(!a.markerCount||l[c]<a.markerCount)&&f.removeClass(h+"-"+c)});c.each(a.viewportMarker,
function(c,b){"undefined"===typeof m[b]&&(m[b]=0);b<=k&&(!a.viewportMarkerCount||m[b]++<a.viewportMarkerCount)&&f.addClass(h+"-viewport-"+b);b>k&&(!a.viewportMarkerCount||m[b]<a.viewportMarkerCount)&&f.removeClass(h+"-viewport-"+b)});if(e!=n)if(e=q(a.classInitial),d.removeClass(e),n){if(d.trigger("in-view"),!a.count||r++<a.count)e=q(a.classHidden),f.length&&f.addClass(h).removeClass(e),d.trigger("in-view-pass")}else if(d.trigger("out-of-view"),!a.count||r<a.count)e=q(a.classHidden),f.length&&f.addClass(e).removeClass(h),
d.trigger("out-of-view-pass");p=!1}};t=t.add(b);w||(w=!0,c(f).on("load scroll",x))}var w=!1,y=0,h=[],t=c(),x=function(b){c(this).scrollTop();c(this).scrollLeft();t.each(function(){var a=h[c(this).data("in-view")];a instanceof u&&a.check()})},v=function(b){var a=b.split(/\s*,\s*/);""==a[0]&&(a=[]);var d={};b=a.length;c.each(a,function(a,b){b=100*(parseFloat(b)||0);d[b]=b});if(a.length){a=a[0].match(/([0-9]+)\s*\/\s*([0-9]+)/);if(1===b&&a)for(b=parseFloat(a[2])||1,b=(parseFloat(a[1])||0)/(0==b?1:b),
a=0,b=1/b;100>=a;a+=b)d[a]=a;d[0]=0;d[100]=100}return d};c.fn.inView=function(b){var a=[],d=this.each(function(){var d=c(this).data("in-view"),e=null;d&&"undefined"!==typeof h[d]?e=h[d]||null:(d=++y,c(this).data("in-view",d));null!==e&&b?a.push(e):(e=new u(this,b),h[d]=e)}),e=a.length;return e?1===e?a[0]:a:d};c.visiblityFactor=function(b){b=c(b).get(0);for(var a=b.offsetTop,d=b.offsetHeight;b.offsetParent;)b=b.offsetParent,a+=b.offsetTop;return(f.pageYOffset+f.innerHeight-a)/d};c.viewportVisiblityFactor=
function(b){return 1-c(b).get(0).getBoundingClientRect().top/f.innerHeight};c.isVisible=function(b,a){var d=c(b).get(0),e=d.offsetTop,h=d.offsetLeft,l=d.offsetWidth,m=d.offsetHeight,n=0,p=0,r=0,k=0;"undefined"!==typeof a&&(n=1<Math.abs(a.left)?a.left:a.left*l,p=1<Math.abs(a.right)?a.right:a.right*l,r=1<Math.abs(a.top)?a.top:a.top*m,k=1<Math.abs(a.bottom)?a.bottom:a.bottom*m);for(;d.offsetParent;)d=d.offsetParent,e+=d.offsetTop,h+=d.offsetLeft;return e+r<f.pageYOffset+f.innerHeight&&h+n<f.pageXOffset+
f.innerWidth&&e+m+k>f.pageYOffset&&h+l+p>f.pageXOffset};c(function(){c("[data-iv-detect=false],[iv-detect=false]").first().length||c("[data-iv],[iv]").inView()})}(window,document,window.Zepto||window.jQuery);